Base installation
=================
1) Install Debian 7
2) apt-get install sudo
3) usermod -a -G sudo berk
4) sudo apt-get install vim
5) sudo vi /etc/vim/vimrc (uncomment syntax on)
6) sudo vi /etc/ssh/sshd_config (PermitRootLogin no, Port 7602) RESTART SSH

Firebird (do backup of databases before and after installation !!!)
========
1) sudo apt-get install xinetd
2) sudo apt-get install firebird2.5-classic
3) sudo vi /etc/xinet.d/firebird25 (disable = no, bind = 127.0.0.1, only_from = 127.0.0.1) RESTART XINETD
4) sudo gsec -user sysdba -password masterkey
   modify sysdba -pw ***
   add web -pw ***
   quit
5) sudo mkdir /home/DB
   sudo mkdir /home/DB/backup
   sudo chown -R firebird /home/DB
   sudo chgrp -R firebird /home/DB
   sudo chmod g+w /home/DB/backup
   sudo vi /etc/firebird/2.5/aliases.conf
	SVJIS_TEST = /home/DB/SVJIS_TEST.FDB
	SVJIS_PRODUCTION = /home/DB/SVJIS_PRODUCTION.FDB
   sudo gbak -c -v -user SYSDBA -password *** /home/berk/SVJIS_PRODUCTION_backup_current.fbk localhost:SVJIS_TEST
   sudo gbak -c -v -user SYSDBA -password *** /home/berk/SVJIS_PRODUCTION_backup_current.fbk localhost:SVJIS_PRODUCTION
   install bin/dbbak_production.sh (modify path to gbak, localhost:${database})
   chmod ugo+x dbbak_production.sh
   sudo usermod -a -G firebird berk
   sudo bin/dbbak_production.sh SVJIS_PRODUCTION
   Setup crontab 
   	00 22 * * * /root/bin/dbbak_production.sh SVJIS_PRODUCTION

Tomcat
======
1) sudo apt-get install openjdk-7-jre
2) sudo apt-get install tomcat7
3) sudo mkdir /home/webapps
   sudo mkdir /home/webapps/localhost
   sudo mkdir /home/webapps/test.vybor1491.cz
   sudo mkdir /home/webapps/vybor1491.cz
   sudo mkdir /home/webapps/webstones.cz
   sudo mkdir /home/webapps/www.vybor1491.cz
   sudo chown -R tomcat7 /home/webapps
   sudo chgrp -R tomcat7 /home/webapps
4) sudo touch /etc/authbind/byport/80
   sudo chmod u+x /etc/authbind/byport/80
   sudo chown tomcat7 /etc/authbind/byport/80
   sudo chgrp tomcat7 /etc/authbind/byport/80
   sudo touch /etc/authbind/byport/443
   sudo chmod u+x /etc/authbind/byport/443
   sudo chown tomcat7 /etc/authbind/byport/443
   sudo chgrp tomcat7 /etc/authbind/byport/443
5) sudo vi /etc/default/tomcat7
	JAVA_OPTS="-Djava.awt.headless=true -Xmx512m -XX:+UseConcMarkSweepGC"
	LOGFILE_DAYS=14
	AUTHBIND=yes
   sudo vi /etc/tomcat7/catalina.properties
        db.password=***
6) install /etc/tomcat7/server.xml
7) install ROOT.war, .keystore
   sudo chown tomcat7 /home/webapps/.keystore
   sudo chgrp tomcat7 /home/webapps/.keystore
8) tomcat restart
9) security manager

//-- Added by berk
grant codeBase "file:/usr/lib/jvm/java-7-openjdk-common/jre/lib/ext/*" {
  permission java.security.AllPermission;
};

grant {
  permission java.lang.RuntimePermission "accessClassInPackage.org.apache.tomcat";
  permission java.util.PropertyPermission "FBLog4j", "read";
  permission java.net.SocketPermission "localhost", "resolve";
  permission java.net.SocketPermission "127.0.0.1:3050", "connect,resolve";
  permission java.util.PropertyPermission "user.name", "read";
  permission java.util.PropertyPermission "org.firebirdsql.jdbc.pid", "read";
  permission java.util.PropertyPermission "org.firebirdsql.jdbc.processName", "read";
  permission java.util.PropertyPermission "jxl.nowarnings", "read";
  permission java.util.PropertyPermission "jxl.lang", "read";
  permission java.util.PropertyPermission "*", "read,write";
  permission java.net.SocketPermission "mail.vybor1491.cz", "resolve";
  permission java.net.SocketPermission "81.91.87.10:25", "connect,resolve";
};

grant codeBase "file:/home/webapps/*" {
  permission java.security.AllPermission;
};

SSL cert from Let's Encrypt
===========================
git clone https://github.com/srvrco/getssl
cd getssl/
cp getssl /home/berk/bin

run mkcert.sh
